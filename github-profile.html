<link rel="import" href="../polymer/polymer.html"> <link rel="import" href="../iron-ajax/iron-ajax.html"> <link rel="import" href="./shared-styles.html"> <link rel="import" href="./badge-skeleton.html"> <dom-module id="github-profile"> <template> <style include="shared-styles"></style> <style>:host{display:block;--github-profile-data-padding-left:10px}:host([avatar-right]) .badge{-ms-flex-direction:row-reverse;flex-direction:row-reverse}:host([avatar-right]) .badge__data{padding-left:0;padding-right:var(--github-profile-data-padding-right,--github-profile-data-padding-left)}.hidden{opacity:0;z-index:-1;pointer-events:none}.content{position:relative}.badge,.skeleton{transition:opacity .2s ease-in-out}.badge{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;opacity:0;min-height:var(--github-profile-avatar-size)}.badge--not-hidden{opacity:1}.badge__image{-ms-flex-item-align:start;align-self:flex-start;min-height:50px}.badge__img{display:block;border-radius:var(--github-profile-avatar-radius)}.badge__data{-ms-flex:1;flex:1;padding-left:var(--github-profile-data-padding-left)}.badge__link{text-decoration:none;color:var(--github-profile-link-color,#00f);@apply(--github-profile_badge__link)}.badge__name{font-weight:500;font-size:var(--github-profile-name-font-size,120%);@apply(--github-profile_badge__name)}.badge__field{font-size:90%;color:var(--github-profile-field-color,#414141);@apply(--github-profile_badge__field)}</style> <iron-ajax id="ajax" auto="" url="[[_url]]" handle-as="json" last-response="{{response}}" on-response="_onResponse" on-error="_onError"> </iron-ajax> <div class="content"> <badge-skeleton class$="skeleton [[_computeHidden(loaded)]]" avatar-right$="[[avatarRight]]" avatar-size="[[avatarSize]]"> </badge-skeleton> <div class$="content__data badge badge--not-[[_computeHidden(loaded)]]" itemscope="" itemtype="http://schema.org/Person"> <div class="badge__image"> <a href$="[[response.html_url]]"> <img src$="[[response.avatar_url]]" alt="" width$="[[avatarSize]]" class="badge__img" itemprop="image"> </a> </div> <div class="badge__data"> <div class="badge__name" itemprop="name" role="heading">[[response.name]]</div> <div class="badge__field badge__url"> <a class="badge__link" href$="[[response.html_url]]" itemprop="url">@[[user]]</a> </div> <div class="badge__field badge__email" hidden$="[[!email]]" itemprop="email">[[response.email]]</div> <div class="badge__field badge__location" hidden$="[[!location]]">[[response.location]]</div> <div class="badge__field badge__followers" hidden$="[[!followers]]">[[response.followers]] followers</div> <div class="badge__field badge__company" hidden$="[[!company]]">[[response.company]]</div> <div class="badge__field badge__blog" hidden$="[[!blog]]"> <a class="badge__link" href$="[[response.blog]]">[[response.blog]]</a> </div> <div class="badge__field badge__bio" hidden$="[[!bio]]">[[response.bio]]</div> </div> </div> </div> <content></content> </template> <script>Polymer({
  is: 'github-profile',

  properties: {
    /**
     * Github username without @ sign.
     * Required.
     */
    user: String,

    /**
     * Show location.
     */
    location: {
      type: Boolean,
      value: false
    },

    /**
     * Show followers count.
     */
    followers: {
      type: Boolean,
      value: false
    },

    /**
     * Show company.
     */
    company: {
      type: Boolean,
      value: false
    },

    /**
     * Show blog.
     */
    blog: {
      type: Boolean,
      value: false
    },

    /**
     * Show bio.
     */
    bio: {
      type: Boolean,
      value: false
    },

    /**
     * Show email.
     */
    email: {
      type: Boolean,
      value: false
    },

    /**
     * Github access token used to prevent exceding the quota limits.
     */
    accessToken: {
      type: String,
      value: ''
    },

    /**
     * True if the Github user has been loaded.
     */
    loaded: {
      type: Boolean,
      value: false,
      notify: true,
      readOnly: true
    },

    /**
     * Size in pixels for the avatar.
     */
    avatarSize: {
      type: Number,
      value: 50,
      observer: '_avatarSizeObserver'
    },

    _url: String
  },

  observers: [
    '_computeUrl(user, accessToken)'
  ],

  _computeUrl: function(user, accessToken) {
    var token = '';
    if (accessToken.trim().length) {
      token = '?access_token=' + accessToken;
    }
    this._url = 'https://api.github.com/users/' + user.trim() + token;
  },

  _computeHidden: function(condition) {
    return condition ? 'hidden' : 'visible';
  },

  _onResponse: function() {
    this._setLoaded(true);
  },

  _onError: function(e) {
    this.fire('load-error', {
      error: e.detail.error
    });
  },

  _avatarSizeObserver: function(size) {
    this.customStyle['--github-profile-avatar-size'] = size + 'px';
    this.updateStyles();
  }

  /**
   * Fired when an error is received.
   * @event load-error {{error: Object}} detail Error detail.
   */

}); </script> </dom-module> 